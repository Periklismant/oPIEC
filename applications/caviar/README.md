# Application

Activity recognition for public space surveillance using the [CAVIAR](http://homepages.inf.ed.ac.uk/rbf/CAVIARDATA1/) benchmark dataset.

# Directory Structure
- /datasets. You may place here CAVIAR datasets in a format compatible with Prob-EC.
- /event_description. Domain-dependent rules for activity recognition.
- /auxiliary. CAVIAR-dataset-dependent auxiliary knowledge.

# Dataset Download Instructions
1. Visit this [link](https://owncloud.skel.iit.demokritos.gr/index.php/s/7hNp1pl1PvaoCGX) and download "caviar.zip". It contains various probability-annotated versions of CAVIAR.
2. Extract the contents of "caviar.zip". The resulting folder is organised as follows: 

```
caviar	
└───original	
	└─ 01-Walk1
		└─ ground_truth
			|	01-Walk1_annotation.txt
		└─ smooth
			└─ 0.5
			    |	wk1gtAppearanceIndv_smooth.pbl
			    |	wk1gtMovementIndv_smooth.pbl
			    |	original_smooth_0.5.pl
			└─ 1.0
			    |   ...
			.
			.
			.
			└─ 8.0
		└─ intermediate
		└─ strong
	.
	.
	.
	└─ 28-Fight_Chase
└───enhanced
	└─ 01-Walk1
	.
	.
	.
	└─ 28-Fight_Chase
```
The dataset under the "enhanced" folder may contain "abrupt" events, which aids in the recognition of "fighting" activities. These events may appear in videos 25-28. The subfolders of "enhanced"/"original", e.g., "01-Walk1", contain datasets comprising the "simple-derived events" (SDEs) appearing in the corresponding video, e.g., video number 1, attached with probability values. 

Each "video" folder contains 4 subfolders: "ground_truth", "smooth", "intermediate" and "strong"

- "ground_truth" contains, for each complex event in the video, the list of intervals during which is takes place. 
- "smooth" contains versions of the CAVIAR in which probabilities have only been attached to SDEs (and not to contextual information, e.g., a person's coordinates in some video frame). These probabilities are generated by a Gamma distribution with a varying mean. 
- "intermediate" contains versions of the CAVIAR in which probabilities have additionally been attached to contextual information. 
- "strong" contains versions of the CAVIAR which extend their corresponding "intermediate" versions by including spurius SDEs that do not belong to the original dataset. These SDEs have been added randomly using a uniform distribution. 

Each "noise version" folder contains various subfolders, whose names correspond to the mean of the Gamma distribution used to generate the corresponding version of the dataset. Each of these subfolders contains three files. The one containing "Appearance" in its name includes contextual information, while the other one, containing "Movement" in its name, includes SDEs. These two files comprise a probabilistic version of the corresponding CAVIAR video. The third file is derived by combining the probabilistic facts including in the other two files and transforming them in a format compatible with Prob-EC. Only this third file is compatible with the current version of Prob-EC.

As an example, the folder "caviar/enhanced/25-Fight_RunAway1/intermediate/2.0" contains a probabilistic version of CAVIAR video 25 which (i) includes "abrupt" type events, (ii) both SDEs and contextual information are assigned probability values and (iii) these probability values are generated using a Gamma distribution with mean 2. The file "enhanced_intermediate_2.0.pl" should be the input file of Prob-EC for this version of CAVIAR.

# Execution Instructions

In order to execute Prob-EC, oPIEC or a pipeline of the two systems on one of these CAVIAR versions, you may proceed as follows:

1. Locate the file corresponding to the video and CAVIAR version you would like to test, e.g., "caviar/original/01-Walk1/smooth/0.5/original_smooth_0.5.pl", and move this file to a seperate folder, e.g., "~/Desktop/caviar_test", for convenience.
2. Granted that oPIEC is installed in your system, type: ``` oPIEC --use-case caviar --dataset applications/caviar/datasets/caviar_test run-probec ```, for example, in order to run Prob-EC on the selected CAVIAR version. The command ``` run-pipeline ``` would additionally process the output of Prob-EC with oPIEC. The output of Prob-EC is located in "ProbEC_output/raw/caviar_test.result".
